<div id="{{ self.dom_id() }}">
  <div class="d-flex align-items-center py-2 px-3"
    data-bs-toggle="collapse"
    data-bs-target="#{{ self.collapse_id() }}"
    aria-expanded="false"
    aria-controls="{{ self.collapse_id() }}"
    role="button">
    <div class="me-2 d-flex align-items-center gap-2 flex-grow-0"
      style="min-width: 0;">
      <span class="text-muted small" style="font-weight: 500; min-width: 60px;">
        {% if self.job.job_type == crate::state::job_state::JobType::Loading %}
        Loading
        {% elif self.job.job_type == crate::state::job_state::JobType::Ripping
        %}
        Ripping
        {% elif self.job.job_type == crate::state::job_state::JobType::Uploading
        %}
        Upload
        {% endif %}
      </span>
      {% if let Some(title) = self.job.title %}
      <span class="overflow-hidden" style="min-width: 0; max-width: 400px;">{{
        title }}</span>
      {% endif %}
      {% if self.job.is_error() %}
      <i class="fas fa-times-circle text-danger ms-auto flex-shrink-0"></i>
      {% elif self.job.is_finished() %}
      <i class="fas fa-check-circle text-success ms-auto flex-shrink-0"></i>
      {% elif self.job.is_pending() %}
      <i class="fas fa-hourglass-half text-warning ms-auto flex-shrink-0"></i>
      {% elif self.job.is_processing() %}
      <i
        class="fas fa-circle-notch fa-spin text-muted ms-auto flex-shrink-0"></i>
      {% endif %}
    </div>
    <div class="flex-grow-1">
      <div class="progress" style="height: 8px;">
        {% if self.job.is_processing() %}
        <div class="progress-bar progress-bar-striped progress-bar-animated"
          role="progressbar"
          style="width: {{ self.job.overall_progress_percent() }}%"
          aria-valuenow="{{ self.job.overall_progress_percent() }}"
          aria-valuemin="0"
          aria-valuemax="100">
        </div>
        {% elif self.job.is_completed() %}
        <div
          class="progress-bar {% if self.job.is_finished() %} bg-success {% else
 %} bg-danger {% endif %}"
          role="progressbar"
          style="width: 100%"
          aria-valuenow="100"
          aria-valuemin="0"
          aria-valuemax="100">
        </div>
        {% else %}
        <div class="progress-bar bg-secondary"
          role="progressbar"
          style="width: 0%"
          aria-valuenow="0"
          aria-valuemin="0"
          aria-valuemax="100">
        </div>
        {% endif %}
      </div>
    </div>
    <div class="ms-3 text-light small">
      <strong>{{ self.job.overall_progress_formatted_percentage() }}</strong>
    </div>
    {% if self.job.total_titles_count() > 0 %}
    <div class="ms-3 text-muted small">
      {% if self.job.is_processing() %}
      {% if let Some(position) = self.job.current_title_position() %}
      {{ self.job.completed_titles_count() }}/{{ self.job.total_titles_count()
      }} ({{ position }})
      {% else %}
      {{ self.job.completed_titles_count() }}/{{ self.job.total_titles_count()
      }}
      {% endif %}
      {% else %}
      {{ self.job.completed_titles_count() }}/{{ self.job.total_titles_count()
      }}
      {% endif %}
    </div>
    {% endif %}
    <div class="ms-3 text-muted small">
      {{ self.job.progress.eta }}
    </div>
    <div class="ms-3">
      <i class="fas fa-chevron-up text-muted"></i>
    </div>
  </div>
</div>
