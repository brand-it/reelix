{% import "_poster.html" as macros %}

<div id="{{ self.dom_id() }}">
  <div class="row">
    <div class="col show-img-posters">
      <a class="btn img-poster-btn p-0 mb-2 m-0" href="/tv/{{ tv.id }}">
        {% call macros::poster_stack(
        season.poster_path,
        tv.poster_path
        ) %}{% endcall %}
      </a>
    </div>

    <div class="col" style="width: 75%;">
      <h3 class="tv-name">
        <i class="fa fa-film"></i>
        <a
          class="link-light link-opacity-50-hover link-underline-opacity-25 pb-1"
          href="/tv/{{ tv.id }}">
          {{ tv.title_year() }}
        </a>
        <small class="text-body-secondary">{{ season.name }}</small>
      </h3>

      <div class="tv-facts">
        {% if let Some(first_air_date) = tv.first_air_date %}
        <span>{{ first_air_date }}</span>
        {% endif %}
        {% for genre in tv.genres %}
        <span class="badge rounded-pill text-bg-secondary">{{ genre.name
          }}</span>
        {% endfor %}
      </div>

      <div class="tv-description"><p>{{ tv.overview }}</p></div>
    </div>
  </div>

  <div class="container my-4"
    data-controller="episode-reorder"
    data-episode-reorder-mvdb-id-value="{{ tv.id }}"
    data-episode-reorder-season-number-value="{{ season.season_number }}">
    <div
      class="d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3">
      <div>
        <strong>Reorder FTP episodes</strong>
        <div class="text-muted small">
          Choose a new episode number for any file, then apply.
        </div>
      </div>
    </div>

    <div id="season-action-bar" class="season-action-bar mb-3">
      <div
        class="d-flex flex-wrap align-items-center justify-content-end gap-2 bg-body-tertiary border rounded shadow-sm p-2">
        <button class="btn btn-warning btn-sm"
          data-action="click->episode-reorder#apply">
          Apply reorder
        </button>
        <button class="btn btn-outline-secondary btn-sm"
          data-action="click->episode-reorder#reset">
          Reset selections
        </button>
        {% if seasons_fab.is_visible() %}
        <a class="btn btn-success btn-sm" href="/rip_season">
          Rip selected titles
        </a>
        {% endif %}
      </div>
    </div>

    {# seasons/episodes.html #}
    {{ seasons_episodes.render_html() | safe }}
  </div>
</div>
