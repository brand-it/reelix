{% macro movie_card_with_title(title, disk, job) %}
  <div class="col-md-6" id="movie-card-title-{{ title.id }}">
    <div class="card mb-3">
      <div class="card-header">
        {{ title.filename.as_deref().unwrap_or("") }}
        ({{ title.chapter_count.unwrap_or(0) }} Chapter(s))
      </div>

      {% if let Some(job) = job %}
        {% if job.matching_title(&title) %}
          <div class="progress"
               role="progressbar"
               aria-valuenow="{{ job.progress.percent }}"
               aria-valuemin="0"
               aria-valuemax="100"
               style="height: 2px">
            <div class="progress-bar"
                 style="width: {{ job.progress.percent }}%"></div>
          </div>
        {% else %}
          <div class="progress"
               role="progressbar"
               aria-label="Example 1px high"
               aria-valuenow="0"
               aria-valuemin="0"
               aria-valuemax="100"
               style="height: 2px">
            <div class="progress-bar" style="width: 0%"></div>
          </div>
        {% endif %}
      {% else %}
        <div class="progress"
             role="progressbar"
             aria-label="Example 1px high"
             aria-valuenow="0"
             aria-valuemin="0"
             aria-valuemax="100"
             style="height: 2px">
          <div class="progress-bar" style="width: 0%"></div>
        </div>
      {% endif %}

      <div class="card-body">
        <strong>Duration:</strong> {{ title.duration.as_deref().unwrap_or("") }} |
        <strong>Size:</strong> {{ title.size.as_deref().unwrap_or("") }} |
        <strong>Lang:</strong> {{ title.lang.as_deref().unwrap_or("") }} |
        <strong>Seg Map:</strong> {{ title.segment_map.as_deref().unwrap_or("") }}

        {% if let Some(job) = job %}
          {% if job.matching_title(&title) %}
            <div class="btn btn-outline-primary btn-sm disabled" disabled="disabled">
              <i class="fad fa-compact-disc fa-spinner fa-pulse"></i> Processing ...
            </div>
          {% else %}
            <a class="btn btn-outline-secondary disabled placeholder col-4"></a>
          {% endif %}
        {% else %}
          <a class="btn btn-outline-success btn-sm"
             data-rip-movie-target="link"
             data-action="click->rip-movie#rip"
             data-disk-id="{{ disk.id }}"
             data-title-id="{{ title.id }}"
             tooltip="Create MKV From Title">
            <i class="fad fa-compact-disc"></i> Create MKV
          </a>
        {% endif %}
      </div>
    </div>
  </div>
{% endmacro movie_card_with_title %}

<div class="row" id="movie-cards-selector">
  {% if let Some(disk) = selected_disk %}
    {% if disk.any_titles() %}
      {% for title in disk.clone_titles() %}
        {% call movie_card_with_title(title=title, disk=disk, job=job) %}
      {% endfor %}
    {% else %}
      <div class="d-flex justify-content-center align-items-center py-3">
        <i class="fad fa-spinner fa-pulse"></i>
        <span class="ms-2">Loading {{ disk.name }} Titlesâ€¦</span>
      </div>
      {% for _ in 0..6 %}
        <div class="col-md-6">
          <div class="card mb-3">
            <div class="card-header placeholder-glow">
              <span class="placeholder col-8"></span>
            </div>
            <div class="progress" style="height: 2px">
              <div class="progress-bar" style="width: 0%"></div>
            </div>
            <div class="card-body placeholder-glow">
              <p>
                <span class="placeholder col-5"></span> |
                <span class="placeholder col-4"></span> |
                <span class="placeholder col-3"></span>
              </p>
              <p><span class="placeholder col-6"></span></p>
              <a class="btn btn-outline-success disabled placeholder col-4"></a>
            </div>
          </div>
        </div>
      {% endfor %}
    {% endif %}
  {% endif %}
</div>
